{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: 'OrderDetail',\n  data() {\n    return {\n      order: [],\n      showUpdateStatusDialog: false,\n      newStatus: '',\n      isFarmer: false,\n      id: 0\n    };\n  },\n  mounted() {\n    this.id = this.$route.params.id;\n    console.log(this.id);\n    this.isFarmer = this.$route.params.role === 'FARMER'; // 根据角色判断\n    this.fetchOrderDetails(id);\n  },\n  methods: {\n    fetchOrderDetails(orderId) {\n      this.$request.get(`/orders/${orderId}`) // 根据订单 ID 获取详情\n      .then(response => {\n        this.order = response.data; // 设置订单详情\n        if (response.code != \"200\") this.$message.error(\"数据获取错误\");\n        console.log(this.order);\n      }).catch(error => {\n        this.$message.error('获取订单详情失败');\n      });\n    },\n    cancelOrder() {\n      this.$request.post(`/orders/cancel`, {\n        orderId: this.order.id\n      }).then(response => {\n        this.$message.success('订单已成功取消');\n        this.$router.push({\n          name: 'Orders'\n        }); // 返回订单列表\n      }).catch(error => {\n        this.$message.error('取消订单失败');\n      });\n    },\n    updateOrderStatus() {\n      this.$request.post(`/orders/update-status`, {\n        orderId: this.order.id,\n        newStatus: this.newStatus\n      }).then(response => {\n        this.order.status = this.newStatus; // 更新本地订单状态\n        this.$message.success('订单状态已成功更改');\n        this.showUpdateStatusDialog = false; // 关闭弹窗\n      }).catch(error => {\n        this.$message.error('更新订单状态失败');\n      });\n    }\n  }\n};","map":{"version":3,"names":["name","data","order","showUpdateStatusDialog","newStatus","isFarmer","id","mounted","$route","params","console","log","role","fetchOrderDetails","methods","orderId","$request","get","then","response","code","$message","error","catch","cancelOrder","post","success","$router","push","updateOrderStatus","status"],"sources":["src/views/User/OrderDetails.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <h2>订单详情</h2>\r\n    <div class=\"order-details\">\r\n      <p>农户姓名: {{ order.farmer_name }}</p>\r\n      <p>农户邮箱: {{ order.farmer_email }}</p>\r\n      <p>用户名: {{ order.username }}</p>\r\n      <p>用户邮箱: {{ order.user_email }}</p>\r\n      <p>区域面积: {{ order.area }} 平方米</p>\r\n      <p>种植状态: {{ order.status }}</p>\r\n      <p>开始时间: {{ order.begin_time }}</p>\r\n      <p>结束时间: {{ order.end_time }}</p>\r\n    </div>\r\n    <div class=\"actions\">\r\n      <button @click=\"cancelOrder\">取消订单</button>\r\n      <button v-if=\"isFarmer\" @click=\"showUpdateStatusDialog = true\">更改订单状态</button>\r\n    </div>\r\n\r\n    <!-- 修改状态弹窗 -->\r\n    <el-dialog :visible.sync=\"showUpdateStatusDialog\" title=\"更改订单状态\">\r\n      <el-input v-model=\"newStatus\" placeholder=\"输入新的状态\"></el-input>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"showUpdateStatusDialog = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"updateOrderStatus\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'OrderDetail',\r\n  data() {\r\n    return {\r\n      order: [],\r\n      showUpdateStatusDialog: false,\r\n      newStatus: '',\r\n      isFarmer: false,\r\n      id:0\r\n    };\r\n  },\r\n  mounted() {\r\n    this.id = this.$route.params.id;\r\n    console.log(this.id);\r\n    this.isFarmer = this.$route.params.role === 'FARMER'; // 根据角色判断\r\n    this.fetchOrderDetails(id)\r\n  },\r\n  methods: {\r\n    fetchOrderDetails(orderId) {\r\n      this.$request.get(`/orders/${orderId}`) // 根据订单 ID 获取详情\r\n          .then(response => {\r\n            this.order = response.data; // 设置订单详情\r\n            if(response.code != \"200\")\r\n              this.$message.error(\"数据获取错误\")\r\n            console.log(this.order)\r\n          })\r\n          .catch(error => {\r\n            this.$message.error('获取订单详情失败');\r\n          });\r\n    },\r\n\r\n    cancelOrder() {\r\n      this.$request.post(`/orders/cancel`, { orderId: this.order.id })\r\n          .then(response => {\r\n            this.$message.success('订单已成功取消');\r\n            this.$router.push({ name: 'Orders' }); // 返回订单列表\r\n          })\r\n          .catch(error => {\r\n            this.$message.error('取消订单失败');\r\n          });\r\n    },\r\n    updateOrderStatus() {\r\n      this.$request.post(`/orders/update-status`, {\r\n        orderId: this.order.id,\r\n        newStatus: this.newStatus,\r\n      })\r\n          .then(response => {\r\n            this.order.status = this.newStatus; // 更新本地订单状态\r\n            this.$message.success('订单状态已成功更改');\r\n            this.showUpdateStatusDialog = false; // 关闭弹窗\r\n          })\r\n          .catch(error => {\r\n            this.$message.error('更新订单状态失败');\r\n          });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.order-details {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.actions {\r\n  margin-top: 20px;\r\n}\r\n\r\n.actions button {\r\n  margin-right: 10px;\r\n}\r\n</style>\r\n"],"mappings":";AA8BA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,KAAA;MACAC,sBAAA;MACAC,SAAA;MACAC,QAAA;MACAC,EAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAD,EAAA,QAAAE,MAAA,CAAAC,MAAA,CAAAH,EAAA;IACAI,OAAA,CAAAC,GAAA,MAAAL,EAAA;IACA,KAAAD,QAAA,QAAAG,MAAA,CAAAC,MAAA,CAAAG,IAAA;IACA,KAAAC,iBAAA,CAAAP,EAAA;EACA;EACAQ,OAAA;IACAD,kBAAAE,OAAA;MACA,KAAAC,QAAA,CAAAC,GAAA,YAAAF,OAAA;MAAA,CACAG,IAAA,CAAAC,QAAA;QACA,KAAAjB,KAAA,GAAAiB,QAAA,CAAAlB,IAAA;QACA,IAAAkB,QAAA,CAAAC,IAAA,WACA,KAAAC,QAAA,CAAAC,KAAA;QACAZ,OAAA,CAAAC,GAAA,MAAAT,KAAA;MACA,GACAqB,KAAA,CAAAD,KAAA;QACA,KAAAD,QAAA,CAAAC,KAAA;MACA;IACA;IAEAE,YAAA;MACA,KAAAR,QAAA,CAAAS,IAAA;QAAAV,OAAA,OAAAb,KAAA,CAAAI;MAAA,GACAY,IAAA,CAAAC,QAAA;QACA,KAAAE,QAAA,CAAAK,OAAA;QACA,KAAAC,OAAA,CAAAC,IAAA;UAAA5B,IAAA;QAAA;MACA,GACAuB,KAAA,CAAAD,KAAA;QACA,KAAAD,QAAA,CAAAC,KAAA;MACA;IACA;IACAO,kBAAA;MACA,KAAAb,QAAA,CAAAS,IAAA;QACAV,OAAA,OAAAb,KAAA,CAAAI,EAAA;QACAF,SAAA,OAAAA;MACA,GACAc,IAAA,CAAAC,QAAA;QACA,KAAAjB,KAAA,CAAA4B,MAAA,QAAA1B,SAAA;QACA,KAAAiB,QAAA,CAAAK,OAAA;QACA,KAAAvB,sBAAA;MACA,GACAoB,KAAA,CAAAD,KAAA;QACA,KAAAD,QAAA,CAAAC,KAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}